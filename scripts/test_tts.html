<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç²¤è¯­TTSæµ‹è¯•</title>
</head>
<body>
    <h1>ç²¤è¯­TTSåŠŸèƒ½æµ‹è¯•</h1>
    
    <div style="margin: 20px; padding: 20px; border: 1px solid #ccc;">
        <h3>æµ‹è¯•1: Web Speech API (æµè§ˆå™¨åŸç”Ÿ)</h3>
        <button onclick="testSpeechAPI()">æµ‹è¯•æœ—è¯»"ä¸€ jat1"</button>
        <div id="speech-api-result" style="margin-top: 10px; color: #666;"></div>
    </div>
    
    <div style="margin: 20px; padding: 20px; border: 1px solid #ccc;">
        <h3>æµ‹è¯•2: éŸ³é¢‘æ–‡ä»¶æ’­æ”¾</h3>
        <button onclick="testAudioPlayback()">æµ‹è¯•æ’­æ”¾é¢„è®¾éŸ³é¢‘</button>
        <audio id="test-audio" controls style="display: none;">
            <source src="https://www.soundjay.com/buttons/button-3.mp3" type="audio/mp3">
        </audio>
        <div id="audio-result" style="margin-top: 10px; color: #666;"></div>
    </div>
    
    <div style="margin: 20px; padding: 20px; border: 1px solid #ccc;">
        <h3>æµ‹è¯•3: æ£€æŸ¥æµè§ˆå™¨TTSæ”¯æŒ</h3>
        <button onclick="checkTTSSupport()">æ£€æŸ¥TTSæ”¯æŒæƒ…å†µ</button>
        <div id="tts-support" style="margin-top: 10px; color: #666;"></div>
    </div>
    
    <script>
        function testSpeechAPI() {
            const resultDiv = document.getElementById('speech-api-result');
            
            if (!('speechSynthesis' in window)) {
                resultDiv.innerHTML = 'âŒ æµè§ˆå™¨ä¸æ”¯æŒWeb Speech API';
                return;
            }
            
            // åœæ­¢å½“å‰ä»»ä½•è¯­éŸ³
            speechSynthesis.cancel();
            
            // åˆ›å»ºè¯­éŸ³å®ä¾‹
            const utterance = new SpeechSynthesisUtterance('ä¸€ jat1');
            
            // å°è¯•è®¾ç½®ç²¤è¯­
            utterance.lang = 'zh-HK'; // ç²¤è¯­ï¼ˆé¦™æ¸¯ï¼‰
            utterance.rate = 0.8; // ç¨æ…¢é€Ÿåº¦
            
            utterance.onstart = function() {
                resultDiv.innerHTML = 'ğŸ”Š æ­£åœ¨æœ—è¯»...';
            };
            
            utterance.onend = function() {
                resultDiv.innerHTML = 'âœ… æœ—è¯»å®Œæˆ';
            };
            
            utterance.onerror = function(event) {
                resultDiv.innerHTML = 'âŒ æœ—è¯»å‡ºé”™: ' + event.error;
            };
            
            // è·å–å¯ç”¨è¯­éŸ³
            const voices = speechSynthesis.getVoices();
            console.log('å¯ç”¨è¯­éŸ³:', voices);
            
            // å°è¯•æ‰¾åˆ°ç²¤è¯­è¯­éŸ³
            const cantoneseVoice = voices.find(voice => 
                voice.lang.includes('zh-HK') || 
                voice.lang.includes('yue') ||
                voice.name.toLowerCase().includes('cantonese')
            );
            
            if (cantoneseVoice) {
                utterance.voice = cantoneseVoice;
                resultDiv.innerHTML = 'âœ… æ‰¾åˆ°ç²¤è¯­è¯­éŸ³: ' + cantoneseVoice.name;
            } else {
                resultDiv.innerHTML = 'âš ï¸ æœªæ‰¾åˆ°ç²¤è¯­è¯­éŸ³ï¼Œä½¿ç”¨é»˜è®¤è¯­éŸ³';
            }
            
            speechSynthesis.speak(utterance);
        }
        
        function testAudioPlayback() {
            const audio = document.getElementById('test-audio');
            const resultDiv = document.getElementById('audio-result');
            
            audio.play().then(() => {
                resultDiv.innerHTML = 'âœ… éŸ³é¢‘æ’­æ”¾æˆåŠŸ';
            }).catch(error => {
                resultDiv.innerHTML = 'âŒ éŸ³é¢‘æ’­æ”¾å¤±è´¥: ' + error.message;
            });
        }
        
        function checkTTSSupport() {
            const resultDiv = document.getElementById('tts-support');
            let html = '';
            
            // æ£€æŸ¥Web Speech API
            if ('speechSynthesis' in window) {
                html += 'âœ… æ”¯æŒWeb Speech API<br>';
                
                const voices = speechSynthesis.getVoices();
                html += `å¯ç”¨è¯­éŸ³æ•°é‡: ${voices.length}<br>`;
                
                // æ£€æŸ¥ç²¤è¯­è¯­éŸ³
                const cantoneseVoices = voices.filter(voice => 
                    voice.lang.includes('zh-HK') || 
                    voice.lang.includes('yue') ||
                    voice.name.toLowerCase().includes('cantonese')
                );
                
                if (cantoneseVoices.length > 0) {
                    html += `âœ… æ‰¾åˆ° ${cantoneseVoices.length} ä¸ªç²¤è¯­è¯­éŸ³:<br>`;
                    cantoneseVoices.forEach(voice => {
                        html += `&nbsp;&nbsp;- ${voice.name} (${voice.lang})<br>`;
                    });
                } else {
                    html += 'âŒ æœªæ‰¾åˆ°ç²¤è¯­è¯­éŸ³<br>';
                    
                    // æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨è¯­éŸ³
                    html += 'æ‰€æœ‰å¯ç”¨è¯­éŸ³:<br>';
                    voices.slice(0, 10).forEach(voice => {
                        html += `&nbsp;&nbsp;- ${voice.name} (${voice.lang})<br>`;
                    });
                    if (voices.length > 10) {
                        html += `&nbsp;&nbsp;... è¿˜æœ‰ ${voices.length - 10} ä¸ªè¯­éŸ³<br>`;
                    }
                }
            } else {
                html += 'âŒ ä¸æ”¯æŒWeb Speech API<br>';
            }
            
            // æ£€æŸ¥Audio API
            if ('Audio' in window) {
                html += 'âœ… æ”¯æŒAudio API<br>';
            } else {
                html += 'âŒ ä¸æ”¯æŒAudio API<br>';
            }
            
            resultDiv.innerHTML = html;
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥è¯­éŸ³
        window.addEventListener('load', function() {
            // æŸäº›æµè§ˆå™¨éœ€è¦è§¦å‘ä¸€æ¬¡getVoicesæ‰èƒ½åŠ è½½è¯­éŸ³åˆ—è¡¨
            speechSynthesis.getVoices();
            
            // å»¶è¿Ÿä¸€ç‚¹å†æ£€æŸ¥ï¼Œç¡®ä¿è¯­éŸ³åŠ è½½å®Œæˆ
            setTimeout(checkTTSSupport, 1000);
        });
    </script>
</body>
</html>